---
title: SAML 2.0 provider setup
description: Configure SAML 2.0 authentication for enterprise identity providers
---

## Overview

SAML 2.0 (Security Assertion Markup Language) is an XML-based authentication protocol commonly used in enterprise environments. It enables single sign-on with enterprise identity providers like Okta, OneLogin, Microsoft Entra ID, and others.

## Key concepts

- **Service Provider (SP)**: Your application (the service users are trying to access)
- **Identity Provider (IdP)**: The SAML provider that authenticates users
- **Assertion**: XML document containing user authentication and attributes
- **Metadata**: XML document describing SP or IdP configuration
- **Entity ID**: Unique identifier for the SP or IdP

## Configuration via admin UI

<Steps>
  <Step title="Navigate to SSO providers">
    Go to Admin → SSO Providers in your dashboard
  </Step>
  
  <Step title="Add SAML provider">
    Click "Add Provider" and select "SAML 2.0" as the provider type
  </Step>
  
  <Step title="Enter basic information">
    ```
    Provider name: Okta SAML
    Provider ID: okta-saml
    Enabled: Yes
    ```
  </Step>
  
  <Step title="Configure SAML settings">
    ```
    SSO URL: https://your-domain.okta.com/app/abc123/sso/saml
    Entity ID: http://www.okta.com/abc123
    Certificate: [Paste X.509 certificate]
    ```
  </Step>
  
  <Step title="Download SP metadata">
    Download your Service Provider metadata to configure in your IdP
  </Step>
  
  <Step title="Save and test">
    Save the configuration and test the login flow
  </Step>
</Steps>

## Service Provider metadata

Your application provides SAML metadata at:

```
https://your-domain.com/auth/saml/[provider-id]/metadata
```

This metadata includes:
- Entity ID (SP identifier)
- Assertion Consumer Service (ACS) URL
- Single Logout Service URL
- X.509 certificate (if request signing is enabled)

## Required SAML configuration

### Identity Provider settings

| Field | Description | Required | Example |
|-------|-------------|----------|---------|
| SSO URL | SAML single sign-on endpoint | Yes | `https://idp.example.com/sso/saml` |
| Entity ID | IdP entity identifier | Yes | `http://www.okta.com/abc123` |
| Certificate | X.509 certificate for signature validation | Yes | `-----BEGIN CERTIFICATE-----...` |

### Service Provider settings

| Field | Description | Default |
|-------|-------------|---------|
| Entity ID | SP entity identifier | `https://your-domain.com/auth/saml/[provider-id]` |
| ACS URL | Assertion Consumer Service URL | `https://your-domain.com/auth/saml/[provider-id]/callback` |
| SLS URL | Single Logout Service URL | `https://your-domain.com/auth/saml/[provider-id]/logout` |

### Optional settings

| Field | Description | Default |
|-------|-------------|---------|
| Sign requests | Sign SAML authentication requests | No |
| Private key | Private key for signing requests | Required if signing enabled |
| Name ID format | Format for user identifier | `urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress` |
| Force authentication | Require re-authentication on each login | No |

## Provider-specific guides

### Okta SAML

<Steps>
  <Step title="Create SAML application">
    1. Log in to Okta admin console
    2. Go to Applications → Applications
    3. Click "Create App Integration"
    4. Select "SAML 2.0"
  </Step>
  
  <Step title="Configure general settings">
    ```
    App name: Your Application
    App logo: [Optional]
    ```
  </Step>
  
  <Step title="Configure SAML settings">
    ```
    Single sign on URL: https://your-domain.com/auth/saml/okta/callback
    Audience URI (SP Entity ID): https://your-domain.com/auth/saml/okta
    Name ID format: EmailAddress
    Application username: Email
    ```
  </Step>
  
  <Step title="Configure attribute statements">
    Map Okta attributes to SAML attributes:
    ```
    email: user.email
    firstName: user.firstName
    lastName: user.lastName
    groups: appuser.groups (if using group mapping)
    ```
  </Step>
  
  <Step title="Get IdP metadata">
    1. Go to the "Sign On" tab
    2. Click "View SAML setup instructions"
    3. Copy the Identity Provider Single Sign-On URL
    4. Copy the Identity Provider Issuer
    5. Download the X.509 Certificate
  </Step>
  
  <Step title="Configure in admin UI">
    Enter the values from Okta into your application's SAML provider settings
  </Step>
</Steps>

### Microsoft Entra ID (Azure AD) SAML

<Steps>
  <Step title="Create enterprise application">
    1. Go to Azure Portal → Microsoft Entra ID
    2. Navigate to Enterprise applications
    3. Click "New application"
    4. Select "Create your own application"
    5. Choose "Integrate any other application you don't find in the gallery (Non-gallery)"
  </Step>
  
  <Step title="Configure single sign-on">
    1. Go to Single sign-on
    2. Select "SAML"
    3. Click "Edit" on Basic SAML Configuration
  </Step>
  
  <Step title="Enter SAML settings">
    ```
    Identifier (Entity ID): https://your-domain.com/auth/saml/azure
    Reply URL (ACS URL): https://your-domain.com/auth/saml/azure/callback
    Sign on URL: https://your-domain.com
    Logout URL: https://your-domain.com/auth/saml/azure/logout
    ```
  </Step>
  
  <Step title="Configure attributes">
    Add user attributes and claims:
    ```
    email: user.mail
    givenname: user.givenname
    surname: user.surname
    groups: user.groups (requires group claim configuration)
    ```
  </Step>
  
  <Step title="Download metadata">
    1. In the SAML Signing Certificate section
    2. Download "Certificate (Base64)"
    3. Copy "Login URL" (SSO URL)
    4. Copy "Azure AD Identifier" (Entity ID)
  </Step>
  
  <Step title="Configure in admin UI">
    Enter the Azure AD values into your SAML provider settings
  </Step>
</Steps>

### OneLogin SAML

<Steps>
  <Step title="Create SAML application">
    1. Log in to OneLogin admin portal
    2. Go to Applications → Applications
    3. Click "Add App"
    4. Search for "SAML Custom Connector (Advanced)"
  </Step>
  
  <Step title="Configure application details">
    Enter your application name and upload a logo (optional)
  </Step>
  
  <Step title="Configure SAML settings">
    Go to the Configuration tab:
    ```
    Audience (EntityID): https://your-domain.com/auth/saml/onelogin
    Recipient: https://your-domain.com/auth/saml/onelogin/callback
    ACS (Consumer) URL: https://your-domain.com/auth/saml/onelogin/callback
    ACS (Consumer) URL Validator: https://your-domain\.com/auth/saml/onelogin/callback
    ```
  </Step>
  
  <Step title="Configure parameters">
    Go to the Parameters tab and add:
    ```
    Email: Email
    FirstName: First Name
    LastName: Last Name
    ```
  </Step>
  
  <Step title="Get IdP information">
    Go to the SSO tab:
    1. Copy "SAML 2.0 Endpoint (HTTP)"
    2. Copy "Issuer URL"
    3. View and copy the X.509 Certificate
  </Step>
  
  <Step title="Configure in admin UI">
    Enter the OneLogin values into your SAML provider settings
  </Step>
</Steps>

## SAML attribute mapping

Configure how SAML attributes map to user fields:

| SAML Attribute | Application Field | Description |
|----------------|-------------------|-------------|
| `email` or `mail` | Email | User's email address |
| `firstName` or `givenName` | First name | User's first name |
| `lastName` or `surname` | Last name | User's last name |
| `displayName` | Full name | User's display name |
| `groups` or `memberOf` | Groups | User's group memberships |

<Note>
Attribute names are case-sensitive and vary by identity provider. Check your IdP's documentation for exact attribute names.
</Note>

## Request signing

Enable request signing for enhanced security:

<Steps>
  <Step title="Generate key pair">
    Generate an RSA private key and certificate:
    ```bash
    openssl req -x509 -newkey rsa:2048 -keyout private.key -out certificate.crt -days 365 -nodes
    ```
  </Step>
  
  <Step title="Enable signing in admin UI">
    1. Toggle "Sign requests" to enabled
    2. Paste the private key content
    3. The certificate is automatically included in SP metadata
  </Step>
  
  <Step title="Update IdP configuration">
    Upload the certificate to your identity provider or provide the updated SP metadata URL
  </Step>
</Steps>

<Warning>
Keep your private key secure. Store it safely and never commit it to version control.
</Warning>

## Troubleshooting

### Invalid signature error

**Problem**: IdP rejects authentication requests or responses fail validation

**Solution**:
- Verify the X.509 certificate is correct and not expired
- Check that the certificate format is correct (PEM format with headers)
- Ensure the certificate matches the one configured in your IdP
- Verify request signing settings match between SP and IdP

### Attribute not found

**Problem**: User attributes are missing after authentication

**Solution**:
- Check attribute mapping in your IdP configuration
- Verify attribute names match exactly (case-sensitive)
- Review the SAML assertion in audit logs to see what attributes are sent
- Ensure your IdP is configured to send the required attributes

### Invalid ACS URL

**Problem**: IdP rejects the Assertion Consumer Service URL

**Solution**:
- Verify the ACS URL exactly matches in both systems
- Check for trailing slashes or protocol mismatches
- Ensure the provider ID in the URL matches your configuration
- Some IdPs require the ACS URL to be explicitly allowed

### Name ID format mismatch

**Problem**: Authentication fails due to Name ID format issues

**Solution**:
- Check the Name ID format in your IdP configuration
- Common formats:
  - `urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress`
  - `urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified`
  - `urn:oasis:names:tc:SAML:2.0:nameid-format:persistent`
- Update the Name ID format in admin UI to match your IdP

### Clock skew errors

**Problem**: Assertions rejected due to timing issues

**Solution**:
- Ensure server clocks are synchronized (use NTP)
- Check that assertion timestamps are within acceptable range
- Some IdPs allow configuring clock skew tolerance

## Security best practices

<AccordionGroup>
  <Accordion title="Validate signatures">
    Always validate SAML assertion signatures using the IdP's certificate. Never disable signature validation in production.
  </Accordion>
  
  <Accordion title="Use HTTPS only">
    All SAML endpoints must use HTTPS. SAML over HTTP is insecure and rejected by most IdPs.
  </Accordion>
  
  <Accordion title="Rotate certificates">
    Regularly rotate your X.509 certificates and update them in both SP and IdP configurations.
  </Accordion>
  
  <Accordion title="Enable request signing">
    Sign SAML requests to prevent tampering and ensure requests originate from your application.
  </Accordion>
  
  <Accordion title="Limit assertion validity">
    Configure short assertion validity periods (5-10 minutes) to reduce replay attack windows.
  </Accordion>
  
  <Accordion title="Monitor audit logs">
    Regularly review SAML authentication logs for suspicious activity or configuration issues.
  </Accordion>
</AccordionGroup>

## Advanced configuration

### Custom Name ID format

Specify a custom Name ID format:

```
urn:oasis:names:tc:SAML:2.0:nameid-format:persistent
```

### Assertion encryption

Some IdPs support assertion encryption for additional security. Contact your IdP administrator to enable this feature.

### Multiple IdP certificates

If your IdP is rotating certificates, you may need to configure multiple certificates during the transition period. Contact support for assistance with this configuration.

## Next steps

<CardGroup cols={2}>
  <Card title="Role mapping" icon="users" href="/authentication/role-mapping">
    Configure group-to-role mappings for SAML attributes
  </Card>
  
  <Card title="User management" icon="user-gear" href="/authentication/user-management">
    Manage users and their connected accounts
  </Card>
  
  <Card title="OIDC setup" icon="key" href="/authentication/oidc">
    Configure OIDC providers as an alternative to SAML
  </Card>
  
  <Card title="Audit logging" icon="list" href="/authentication/audit-logging">
    Monitor SAML authentication events
  </Card>
</CardGroup>
